{% extends "@desk/layout_edit.html" %}

{% block pageTitle %}
  {{ __('Edit Page') }}
{% endblock %}

{% block formAttribute %}
  {{ super() }}
  id="page-edit-form" action="{{ deskUrl('/page/save') }}"
{% endblock %}

{% block action %}
    <button type="submit" name="action" class="btn btn-success">{{ __('Save Page') }}</button>
    <a class="btn btn-default" href="/desk/page">
        <i class="fa fa-times" style="color: #A94442;"></i> <span class="dt-editor-close-text">{{ __('Cancel') }}</span>
    </a>
{% endblock %}

{% block form %}
<input type="hidden" name="page[id]" value="{{ page.id }}">
<div class="row">
    <div class="col-md-9">
        <div class="form-group">
            <input type="text" name="page[title]" value="{{ page.title }}" placeholder="{{ __('Title') }}" class="form-control input-lg">
         </div>
         <div class="form-group">
            <textarea name="page[content]" rows="8" cols="40">{{ page.content }}</textarea>
         </div>
    </div>
    <div class="col-md-3">
        <div class="form-group">
          <input type="text" name="page[slug]" value="{{ page.slug }}" class="form-control" placeholder="{{ __('Slug') }}">
        </div>
        <div class="form-group">
          <label for="status" class="control-label">{{ __('Status') }}</label>
          <select class="form-control" name="page[status]">
            <option value="1">{{ __('Published') }}</option>
            <option value="2">{{ __('Pending Review') }}</option>
          </select>
         </div>
         <div class="form-group">
           <label for="layout" class="control-label">{{ __('Layout') }}</label>
           <select class="form-control" name="page[layout]">
             <option value="default">{{ __('Default') }}</option>
           </select>
         </div>
    </div>
</div>
{% endblock %}

{% block js %}
    {{ super() }}

    <script type="text/javascript" src="/bower_components/ckeditor/ckeditor.js"> </script>
    <script type="text/javascript" src="/page/js/editor.js"> </script>

    <script type="text/javascript">
    CKEDITOR.plugins.addExternal( 'wpmore', '/desk/plugins/ckeditor-custom/plugins/wpmore/', 'plugin.js' );
    CKEDITOR.replace('page[content]', {

        language: drafTerbit.locale,
        customConfig : "/desk/plugins/ckeditor-custom/config.js",
        skin: 'bootstrap,/desk/plugins/ckeditor-custom/skins/bootstrap/',
        extraPlugins: 'wpmore'

        // filebrowserWindowWidth  : 1040,
        // filebrowserWindowHeight : 453,
        // filebrowserImageBrowseUrl : "/desk/file/browser"
    });

    // handle footer position
    CKEDITOR.on("instanceReady", function(event)
    {
        var h = $('.page-wrapper').height();
        var hW = $(window).innerHeight();

        if(h+30 > hW) {
            $('.footer').removeClass('navbar-fixed-bottom');
        }
    });

        {% if page_id == 'new' %}
          drafTerbit.pageEditor.syncSlugAndTitle();
        {% endif %}
    </script>
{% endblock %}
